@page
@model PCM_357.Pages.Matches.CreateModel
@{ ViewData["Title"] = "Ghi nh·∫≠n K·∫øt qu·∫£"; }

<h1 class="mb-4 text-center">Ghi nh·∫≠n K·∫øt qu·∫£ Tr·∫≠n ƒë·∫•u</h1>
<hr />

<div class="row justify-content-center pb-5"> <!-- Added padding bottom to prevent overlap -->
    <div class="col-lg-10">
        <form method="post">
            <div asp-validation-summary="ModelOnly" class="alert alert-danger shadow-sm"></div>
            
            <div class="card p-3 mb-4 shadow-sm">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label asp-for="Match.Date" class="control-label fw-bold">Th·ªùi gian</label>
                        <input asp-for="Match.Date" class="form-control" type="datetime-local" />
                    </div>
                    <div class="col-md-6 mb-3">
                        <label asp-for="Match.MatchFormat" class="control-label fw-bold">Th·ªÉ th·ª©c</label>
                        <select asp-for="Match.MatchFormat" class="form-select" asp-items="Html.GetEnumSelectList<PCM_357.Entities.MatchFormat>()" id="matchFormat"></select>
                    </div>
                </div>
            </div>

            <div class="row">
                <!-- Team 1 -->
                <div class="col-md-6">
                    <div class="card mb-3 border-primary h-100">
                        <div class="card-header bg-primary text-white text-center fw-bold">Team 1 (ƒê·ªôi A)</div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label class="form-label">VƒêV 1 (Ch√≠nh)</label>
                                <select asp-for="Match.Team1_Player1Id" class="form-select" asp-items="Model.MemberList"></select>
                            </div>
                            <div class="mb-3" id="team1_p2_box" style="display: none;">
                                <label class="form-label">VƒêV 2 (ƒê√¥i)</label>
                                <select asp-for="Match.Team1_Player2Id" class="form-select" asp-items="Model.MemberList">
                                    <option value="">-- Tr·ªëng --</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Team 2 -->
                <div class="col-md-6">
                    <div class="card mb-3 border-danger h-100">
                        <div class="card-header bg-danger text-white text-center fw-bold">Team 2 (ƒê·ªôi B)</div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label class="form-label">VƒêV 1 (Ch√≠nh)</label>
                                <select asp-for="Match.Team2_Player1Id" class="form-select" asp-items="Model.MemberList"></select>
                            </div>
                            <div class="mb-3" id="team2_p2_box" style="display: none;">
                                <label class="form-label">VƒêV 2 (ƒê√¥i)</label>
                                <select asp-for="Match.Team2_Player2Id" class="form-select" asp-items="Model.MemberList">
                                     <option value="">-- Tr·ªëng --</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card p-3 mb-4 shadow-sm bg-light">
                <div class="row align-items-center">
                    <div class="col-md-6 mb-3 mb-md-0">
                        <label asp-for="Match.WinningSide" class="control-label fw-bold">K·∫øt qu·∫£ chung cu·ªôc</label>
                        <select asp-for="Match.WinningSide" class="form-select form-select-lg">
                            <option value="None">-- Ch∆∞a x√°c ƒë·ªãnh --</option>
                            <option value="Team1">Team 1 Th·∫Øng</option>
                            <option value="Team2">Team 2 Th·∫Øng</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <div class="form-check form-switch fs-5">
                            <input class="form-check-input" type="checkbox" asp-for="Match.IsRanked">
                            <label class="form-check-label" asp-for="Match.IsRanked">T√≠nh ƒëi·ªÉm h·∫°ng (Ranked)</label>
                        </div>
                    </div>
                </div>
                
                <div class="mt-3">
                    <label asp-for="Match.ChallengeId" class="control-label fw-bold">Thu·ªôc K√®o / Gi·∫£i ƒë·∫•u</label>
                    <select asp-for="Match.ChallengeId" class="form-select" asp-items="Model.ChallengeList">
                        <option value="">-- Giao h·ªØu (Kh√¥ng thu·ªôc gi·∫£i) --</option>
                    </select>
                </div>
            </div>

            <div class="d-grid gap-2">
                <input type="submit" value="üíæ L∆∞u K·∫øt Qu·∫£" class="btn btn-primary btn-lg" />
            </div>
            
            <div class="mt-5"></div> <!-- Spacer -->
        </form>
    </div>
</div>

@section Scripts {
    <script>
        function updateUI() {
            var format = document.getElementById("matchFormat").value;
            // MatchFormat enum: Singles = 1, Doubles = 2
            
            if (format == "1") { // Singles
                 document.getElementById("team1_p2_box").style.display = "none";
                 document.getElementById("team2_p2_box").style.display = "none";
            } else { // Doubles = 2
                 document.getElementById("team1_p2_box").style.display = "block";
                 document.getElementById("team2_p2_box").style.display = "block";
            }
        }
        document.getElementById("matchFormat").addEventListener("change", updateUI);
        updateUI();
    </script>
}
